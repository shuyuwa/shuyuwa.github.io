<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="keywords" content="Hexo Java Vue.js Kubenetes wsl Full-Stack"><meta name="author" content="叶舒雨"><link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="canonical" href="https://shuyuwa.github.io/20240625/c2b0cfa83d1f/"><meta name="robots" content="index,follow"><meta name="googlebot" content="index,follow"><meta name="revisit-after" content="1 days"><meta name="description" content="背景为了练习管理服务器，我打算在自己的电脑上模拟一个企业级内部环境。通过调整 hosts 文件或者内部 DNS 服务器设置，我希望能够使用内部域名访问服务器，而且要求使用 HTTPS 进行访问。为此，我选择在 Windows11 上安装 WSL2，并在 WSL2 中编译安装 Nginx，以实现最大程度的自定义配置。 环境 操作系统：Windows 11 23H2 终端：PowerShell 5.1"><meta property="og:type" content="article"><meta property="og:title" content="从零开始：在 WSL 上编译安装 Nginx，配置 HTTPS 访问"><meta property="og:url" content="https://shuyuwa.github.io/20240625/c2b0cfa83d1f/"><meta property="og:site_name" content="Shuyu&#39;s Blog"><meta property="og:description" content="背景为了练习管理服务器，我打算在自己的电脑上模拟一个企业级内部环境。通过调整 hosts 文件或者内部 DNS 服务器设置，我希望能够使用内部域名访问服务器，而且要求使用 HTTPS 进行访问。为此，我选择在 Windows11 上安装 WSL2，并在 WSL2 中编译安装 Nginx，以实现最大程度的自定义配置。 环境 操作系统：Windows 11 23H2 终端：PowerShell 5.1"><meta property="og:locale" content="zh_CN"><meta property="article:published_time" content="2024-06-25T10:30:53.000Z"><meta property="article:modified_time" content="2024-06-30T13:08:48.692Z"><meta property="article:author" content="叶舒雨"><meta property="article:tag" content="kickoff"><meta property="article:tag" content="wsl"><meta property="article:tag" content="windows"><meta property="article:tag" content="make"><meta property="article:tag" content="nginx"><meta name="twitter:card" content="summary"><link rel="icon" type="image/png" href="/images/favicon.ico" sizes="192x192"><link rel="apple-touch-icon" sizes="180x180" href="/images/favicon.ico"><meta name="theme-color" content="#409EFF"><link rel="shortcut icon" href="/images/favicon.ico"><title>从零开始：在 WSL 上编译安装 Nginx，配置 HTTPS 访问 - Shuyu&#39;s Blog</title><link rel="stylesheet" href="https://registry.npmmirror.com/hexo-theme-redefine/2.6.4/files/source/fonts/Chillax/chillax.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="https://registry.npmmirror.com/hexo-theme-redefine/2.6.4/files/source/assets/build/styles.css"><link rel="stylesheet" href="https://registry.npmmirror.com/hexo-theme-redefine/2.6.4/files/source/fonts/GeistMono/geist-mono.css"><link rel="stylesheet" href="https://registry.npmmirror.com/hexo-theme-redefine/2.6.4/files/source/fonts/Geist/geist.css"><script src="https://registry.npmmirror.com/hexo-theme-redefine/2.6.4/files/source/js/libs/anime.min.js"></script><script id="hexo-configurations">window.config={hostname:"shuyuwa.github.io",root:"/",language:"zh-CN",path:"search.xml"},window.theme={articles:{style:{font_size:"16px",line_height:1.5,image_border_radius:"14px",image_alignment:"center",image_caption:!1,link_icon:!0,title_alignment:"left",headings_top_spacing:{h1:"3.2rem",h2:"2.4rem",h3:"1.9rem",h4:"1.6rem",h5:"1.4rem",h6:"1.3rem"}},word_count:{enable:!0,count:!0,min2read:!0},author_label:{enable:!0,auto:!1,list:[]},code_block:{copy:!0,style:"mac",font:{enable:!1,family:null,url:null}},toc:{enable:!0,max_depth:3,number:!1,expand:!0,init_open:!0},copyright:{enable:!0,default:"cc_by_nc_sa"},lazyload:!0,recommendation:{enable:!0,title:"推荐阅读",limit:3,mobile_limit:2,placeholder:"/images/wallhaven-wqery6-light.webp",skip_dirs:[]}},colors:{primary:"#409EFF",secondary:null,default_mode:"light"},global:{fonts:{chinese:{enable:!1,family:null,url:null},english:{enable:!1,family:null,url:null}},content_max_width:"1000px",sidebar_width:"210px",hover:{shadow:!0,scale:!1},scroll_progress:{bar:!0,percentage:!0},website_counter:{url:"https://cn.vercount.one/js",enable:!1,site_pv:!0,site_uv:!0,post_pv:!0},single_page:!0,preloader:!0,open_graph:!0,google_analytics:{enable:!1,id:null}},home_banner:{enable:!0,style:"fixed",image:{light:"/images/wallhaven-wqery6-light.webp",dark:"/images/wallhaven-wqery6-dark.webp"},title:"Hello World!",subtitle:{text:["宇宙很大，生活更大！"],hitokoto:{enable:!1,api:"https://v1.hitokoto.cn"},typing_speed:100,backing_speed:80,starting_delay:500,backing_delay:1500,loop:!0,smart_backspace:!0},text_color:{light:"#fff",dark:"#d1d1b6"},text_style:{title_size:"2rem",subtitle_size:"1.5rem",line_height:1.2},custom_font:{enable:!1,family:null,url:null},social_links:{enable:!0,style:"default",links:{github:"https://github.com/shuyuwa",instagram:null,zhihu:null,twitter:null,email:null},qrs:{weixin:null}}},plugins:{feed:{enable:!1},aplayer:{enable:!1,type:"fixed",audios:[{name:null,artist:null,url:null,cover:null,lrc:null}]},mermaid:{enable:!1,version:"9.3.0"}},version:"2.6.4",navbar:{auto_hide:!1,color:{left:"#f78736",right:"#367df7",transparency:35},width:{home:"1200px",pages:"1000px"},links:{Home:{path:"/",icon:"fa-regular fa-house"},Archives:{path:"/archives",icon:"fa-regular fa-archive"},Tags:{path:"/tags",icon:"fa-regular fa-tags"},Friends:{path:"/links",icon:"fa-solid fa-link"},Github:{path:"https://github.com/shuyuwa",icon:"fa-brands fa-github"}},search:{enable:!0,preload:!0}},page_templates:{friends_column:2,tags_style:"blur"},home:{sidebar:{enable:!0,position:"left",first_item:"menu",announcement:null,show_on_mobile:!0,links:{Archives:{path:"/archives",icon:"fa-regular fa-archive"},Tags:{path:"/tags",icon:"fa-regular fa-tags"}}},article_date_format:"auto",categories:{enable:!0,limit:3},tags:{enable:!0,limit:3}},footerStart:"2024/6/24 10:00:00"},window.lang_ago={second:"%s 秒前",minute:"%s 分钟前",hour:"%s 小时前",day:"%s 天前",week:"%s 周前",month:"%s 个月前",year:"%s 年前"},window.data={masonry:!1}</script><link rel="stylesheet" href="https://registry.npmmirror.com/hexo-theme-redefine/2.6.4/files/source/fontawesome/fontawesome.min.css"><link rel="stylesheet" href="https://registry.npmmirror.com/hexo-theme-redefine/2.6.4/files/source/fontawesome/brands.min.css"><link rel="stylesheet" href="https://registry.npmmirror.com/hexo-theme-redefine/2.6.4/files/source/fontawesome/solid.min.css"><link rel="stylesheet" href="https://registry.npmmirror.com/hexo-theme-redefine/2.6.4/files/source/fontawesome/regular.min.css"><meta name="generator" content="Hexo 7.2.0"></head><body><div class="progress-bar-container"><span class="scroll-progress-bar"></span> <span class="pjax-progress-bar"></span></div><style>:root{--preloader-background-color:#fff;--preloader-text-color:#000}@media (prefers-color-scheme:dark){:root{--preloader-background-color:#202124;--preloader-text-color:#fff}}@media (prefers-color-scheme:light){:root{--preloader-background-color:#fff;--preloader-text-color:#000}}@media (max-width:600px){.ml13{font-size:2.6rem!important}}.preloader{display:flex;flex-direction:column;gap:1rem;align-items:center;justify-content:center;position:fixed;padding:12px;top:0;right:0;bottom:0;left:0;width:100vw;height:100vh;background-color:var(--preloader-background-color);z-index:1100;transition:opacity .2s ease-in-out}.ml13{font-size:3.2rem;color:var(--preloader-text-color);letter-spacing:-1px;font-weight:500;font-family:Chillax-Variable,sans-serif;text-align:center}.ml13 .word{display:inline-flex;flex-wrap:wrap;white-space:nowrap}.ml13 .letter{display:inline-block;line-height:1em}</style><div class="preloader"><h2 class="ml13">Shuyu&#39;s Blog</h2><script>var textWrapper = document.querySelector('.ml13');
        // Split text into words
        var words = textWrapper.textContent.trim().split(' ');

        // Clear the existing content
        textWrapper.innerHTML = '';

        // Wrap each word and its letters in spans
        words.forEach(function(word) {
            var wordSpan = document.createElement('span');
            wordSpan.classList.add('word');
            wordSpan.innerHTML = word.replace(/\S/g, "<span class='letter'>$&</span>");
            textWrapper.appendChild(wordSpan);
            textWrapper.appendChild(document.createTextNode(' ')); // Add space between words
        });

        var animation = anime.timeline({loop: true})
            .add({
                targets: '.ml13 .letter',
                translateY: [40,0],
                translateZ: 0,
                opacity: [0,1],
                filter: ['blur(5px)', 'blur(0px)'], // Starting from blurred to unblurred
                easing: "easeOutExpo",
                duration: 1400,
                delay: (el, i) => 300 + 30 * i,
            }).add({
                targets: '.ml13 .letter',
                translateY: [0,-40],
                opacity: [1,0],
                filter: ['blur(0px)', 'blur(5px)'], // Ending from unblurred to blurred
                easing: "easeInExpo",
                duration: 1200,
                delay: (el, i) => 100 + 30 * i,
                complete: function() {
                    hidePreloader(); // Call hidePreloader after the animation completes
                }
            });

        let themeStatus = JSON.parse(localStorage.getItem('REDEFINE-THEME-STATUS'))?.isDark;

        // If the theme status is not found in local storage, check the preferred color scheme
        if (themeStatus === undefined || themeStatus === null) {
            if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
                themeStatus = 'dark';
            } else {
                themeStatus = 'light';
            }
        }

        // Now you can use the themeStatus variable in your code
        if (themeStatus) {
            document.documentElement.style.setProperty('--preloader-background-color', '#202124');
            document.documentElement.style.setProperty('--preloader-text-color', '#fff');
        } else {
            document.documentElement.style.setProperty('--preloader-background-color', '#fff');
            document.documentElement.style.setProperty('--preloader-text-color', '#000');
        }

        window.addEventListener('load', function () {
            setTimeout(hidePreloader, 5000); // Call hidePreloader after 5000 milliseconds if not already called by animation
        });

        function hidePreloader() {
            var preloader = document.querySelector('.preloader');
            preloader.style.opacity = '0';
            setTimeout(function () {
                preloader.style.display = 'none';
            }, 200);
        }</script></div><main class="page-container" id="swup"><div class="main-content-container"><div class="main-content-header"><header class="navbar-container px-6 md:px-12"><div class="navbar-content"><div class="left"><a class="logo-title" href="/">Shuyu&#39;s Blog</a></div><div class="right"><div class="desktop"><ul class="navbar-list"><li class="navbar-item"><a href="/"><i class="fa-regular fa-house fa-fw"></i> 首页</a></li><li class="navbar-item"><a href="/archives"><i class="fa-regular fa-archive fa-fw"></i> 归档</a></li><li class="navbar-item"><a href="/tags"><i class="fa-regular fa-tags fa-fw"></i> 标签</a></li><li class="navbar-item"><a href="/links"><i class="fa-solid fa-link fa-fw"></i> 友情链接</a></li><li class="navbar-item"><a target="_blank" rel="noopener" href="https://github.com/shuyuwa"><i class="fa-brands fa-github fa-fw"></i> GITHUB</a></li><li class="navbar-item search search-popup-trigger"><i class="fa-solid fa-magnifying-glass"></i></li></ul></div><div class="mobile"><div class="icon-item search search-popup-trigger"><i class="fa-solid fa-magnifying-glass"></i></div><div class="icon-item navbar-bar"><div class="navbar-bar-middle"></div></div></div></div></div><div class="navbar-drawer h-screen w-full absolute top-0 left-0 bg-background-color flex flex-col justify-between"><ul class="drawer-navbar-list flex flex-col px-4 justify-center items-start"><li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full"><a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full" href="/"><span>首页 </span><i class="fa-regular fa-house fa-sm fa-fw"></i></a></li><li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full"><a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full" href="/archives"><span>归档 </span><i class="fa-regular fa-archive fa-sm fa-fw"></i></a></li><li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full"><a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full" href="/tags"><span>标签 </span><i class="fa-regular fa-tags fa-sm fa-fw"></i></a></li><li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full"><a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full" href="/links"><span>友情链接 </span><i class="fa-solid fa-link fa-sm fa-fw"></i></a></li><li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full"><a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full" target="_blank" rel="noopener" href="https://github.com/shuyuwa"><span>GITHUB </span><i class="fa-brands fa-github fa-sm fa-fw"></i></a></li></ul><div class="statistics flex justify-around my-2.5"><a class="item tag-count-item flex flex-col justify-center items-center w-20" href="/tags"><div class="number text-2xl sm:text-xl text-second-text-color font-semibold">19</div><div class="label text-third-text-color text-sm">标签</div></a><a class="item tag-count-item flex flex-col justify-center items-center w-20" href="/categories"><div class="number text-2xl sm:text-xl text-second-text-color font-semibold">0</div><div class="label text-third-text-color text-sm">分类</div></a><a class="item tag-count-item flex flex-col justify-center items-center w-20" href="/archives"><div class="number text-2xl sm:text-xl text-second-text-color font-semibold">6</div><div class="label text-third-text-color text-sm">文章</div></a></div></div><div class="window-mask"></div></header></div><div class="main-content-body"><div class="main-content"><div class="post-page-container flex relative justify-between box-border w-full h-full"><div class="article-content-container"><div class="article-title relative w-full"><div class="w-full flex items-center pt-6 justify-start"><h1 class="article-title-regular text-second-text-color tracking-tight text-4xl md:text-6xl font-semibold px-2 sm:px-6 md:px-8 py-3">从零开始：在 WSL 上编译安装 Nginx，配置 HTTPS 访问</h1></div></div><div class="article-header flex flex-row gap-2 items-center px-2 sm:px-6 md:px-8"><div class="avatar w-[46px] h-[46px] flex-shrink-0 rounded-medium border border-border-color p-[1px]"><img src="/images/avatar.png"></div><div class="info flex flex-col justify-between"><div class="author flex items-center"><span class="name text-default-text-color text-lg font-semibold">叶舒雨</span> <span class="author-label ml-1.5 text-xs px-2 py-0.5 rounded-small text-third-text-color border border-shadow-color-1">Lv1</span></div><div class="meta-info"><div class="article-meta-info"><span class="article-date article-meta-item"><i class="fa-regular fa-pen-fancy"></i>&nbsp; <span class="desktop">2024-06-25 18:30:53</span> <span class="mobile">2024-06-25 18:30:53</span> <span class="hover-info">创建</span> </span><span class="article-date article-meta-item"><i class="fa-regular fa-wrench"></i>&nbsp; <span class="desktop">2024-06-30 21:08:48</span> <span class="mobile">2024-06-30 21:08:48</span> <span class="hover-info">更新</span> </span><span class="article-tags article-meta-item"><i class="fa-regular fa-tags"></i>&nbsp;<ul><li><a href="/tags/kickoff/">kickoff</a>&nbsp;</li><li>| <a href="/tags/wsl/">wsl</a>&nbsp;</li><li>| <a href="/tags/windows/">windows</a>&nbsp;</li><li>| <a href="/tags/make/">make</a>&nbsp;</li><li>| <a href="/tags/nginx/">nginx</a>&nbsp;</li></ul></span><span class="article-wordcount article-meta-item"><i class="fa-regular fa-typewriter"></i>&nbsp;<span>2.2k 字</span> </span><span class="article-min2read article-meta-item"><i class="fa-regular fa-clock"></i>&nbsp;<span>9 分钟</span></span></div></div></div></div><div class="article-content markdown-body px-2 sm:px-6 md:px-8 pb-8"><h2 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h2><p>为了练习管理服务器，我打算在自己的电脑上模拟一个企业级内部环境。通过调整 hosts 文件或者内部 DNS 服务器设置，我希望能够使用内部域名访问服务器，而且要求使用 HTTPS 进行访问。为此，我选择在 Windows11 上安装 WSL2，并在 WSL2 中编译安装 Nginx，以实现最大程度的自定义配置。</p><h2 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h2><ul><li>操作系统：Windows 11 23H2</li><li>终端：PowerShell 5.1</li></ul><h2 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h2><h3 id="1-安装-wsl"><a href="#1-安装-wsl" class="headerlink" title="1. 安装 wsl"></a>1. 安装 wsl</h3><p>参考微软 <a class="link" target="_blank" rel="noopener" href="https://learn.microsoft.com/zh-cn/windows/wsl">WSL 官方文档 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>。</p><ul><li>在线安装：运行 <code>wsl --list --online</code> 或者 <code>wsl -l -o</code> 查看可安装的有效分发的列表，然后运行 <code>wsl --install &lt;Distribution Name&gt;</code>。</li></ul><blockquote><p>注意：这里的 <code>&lt;Distribution Name&gt;</code> 是运行 <code>wsl -l -o</code> 后左列的 <code>NAME</code> 而不是右列的 <code>FRIENDLY NAME</code></p></blockquote><ul><li>离线安装：由于网络环境的关系，可以选择 <a class="link" target="_blank" rel="noopener" href="https://learn.microsoft.com/zh-cn/windows/wsl/install-manual#downloading-distributions">下载安装包 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a> 进行离线安装。下载好安装包之后，双击安装包开始安装。<br>稍等片刻后，终端会提示你输入一个非 root 的用户名和两次相同的密码，输入完毕会自动以你输入的用户登录 Linux。</li><li>更改安装目录：因为 WSL 的默认安装位置在 C 盘，随着各种操作，WSL 的虚拟磁盘会越来越大，所以我们打开一个新的 PowerShell 终端，依次输入以下命令：</li></ul><div class="highlight-container" data-rel="Powershell"><figure class="iseeu highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 这里的 &lt;Distribution Name&gt; 是运行 wsl -l -v 的 name</span></span><br><span class="line"><span class="comment"># 关闭所有正在运行的 Linux 发行版</span></span><br><span class="line">&gt; wsl <span class="literal">--shutdown</span></span><br><span class="line"><span class="comment"># &lt;FileName&gt; 导出的文件名，可以是绝对路径</span></span><br><span class="line">&gt; wsl <span class="literal">--export</span> &lt;Distribution Name&gt; &lt;FileName&gt;</span><br><span class="line"><span class="comment"># 此命令会删除指定 Linux 的所有内容，注意备份重要文件！</span></span><br><span class="line">&gt; wsl <span class="literal">--unregister</span> &lt;Distribution Name&gt;</span><br><span class="line"><span class="comment"># 1: 允许自定义，如：ubuntu-dev，2: 发行版虚拟磁盘路径，建议放在大容量盘，3: 导出文件的路径</span></span><br><span class="line">&gt; wsl <span class="literal">--import</span> &lt;Distribution Name&gt; &lt;InstallLocation&gt; &lt;FileName&gt;</span><br><span class="line"><span class="comment"># 设置默认启动的 Linux 发行版</span></span><br><span class="line">&gt; wsl <span class="literal">--set-default</span> &lt;Distribution Name&gt;</span><br></pre></td></tr></table></figure></div><p>运行 <code>wsl [path]</code> 以 root 用户登录默认启动的 Linux 发行版，<code>[path]</code> 参数是登录后打开的目录。</p><ul><li>可选：更换软件镜像源<br>以 Ubuntu-24.04 为例：新版的 Debian 和 Ubuntu 采用了 <a class="link" target="_blank" rel="noopener" href="https://repolib.readthedocs.io/en/latest/deb822-format.html">DEB822 格式 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>，运行以下命令更换更快速的镜像源：</li></ul><div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 备份</span></span><br><span class="line"><span class="built_in">cp</span> /etc/apt/sources.list.d/ubuntu.sources /etc/apt/sources.list.d/ubuntu.sources.bak</span><br><span class="line"><span class="comment"># -i 表示直接在文件中进行替换操作 s 表示替换操作 @分隔符，默认 / 作为分隔符，但在处理 url 时为了避免冲突，可以使用其他字符 //.*archive.ubuntu.com 匹配模式，表示匹配以 // 开头，后面跟着任意字符直到 ubuntu.com 的字符串 //[domain] 表示 // 开头，[domain] 镜像源的域名，注意：不包含路径 g 表示全局替换 [file-path] 表示要操作的文件，DEB822 格式以. sources 结尾</span></span><br><span class="line">sed -i <span class="string">&#x27;s@//.*ubuntu.com@//[domain]@g&#x27;</span> [file-path]</span><br><span class="line"><span class="comment"># 默认的源采用的是 http 而不是 https，使用 https 避免运营商的缓存劫持</span></span><br><span class="line">sed -i <span class="string">&#x27;s/http:/https:/g&#x27;</span> [file-path]</span><br><span class="line"><span class="comment"># 更新索引</span></span><br><span class="line">apt-get update</span><br></pre></td></tr></table></figure></div><h3 id="2-安装编译工具"><a href="#2-安装编译工具" class="headerlink" title="2. 安装编译工具"></a>2. 安装编译工具</h3><div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt update &amp;&amp; apt install build-essential zlib1g zlib1g-dev libgd-dev libgdal-dev libpcre3 libpcre3-dev -y</span><br></pre></td></tr></table></figure></div><blockquote><p>有位不知名大佬推荐安装两遍编译工具，使最后显示 <code>0 upgraded, 0 newly installed, 0 to remove and 0 not upgraded.</code>，这样做是为了避免在编译和安装过程中出现由于依赖项未满足导致的错误。（有人知道出处的话请联系我更新）</p></blockquote><h3 id="3-更新-openssl-版本（可选）"><a href="#3-更新-openssl-版本（可选）" class="headerlink" title="3. 更新 openssl 版本（可选）"></a>3. 更新 openssl 版本（可选）</h3><blockquote><p>来自 <a class="link" target="_blank" rel="noopener" href="https://www.openssl.org/source/">openssl 官网 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>：All older versions (including 1.1.1, 1.1.0, 1.0.2, 1.0.0 and 0.9.8) are now out of support and should not be used. Users of these older versions are encouraged to upgrade to 3.2 or 3.0 as soon as possible. 所有旧版本（包括 1.1.1、1.1.0、1.0.2、1.0.0 和 0.9.8）现在都不再支持，不应再使用。使用这些旧版本的用户应尽快升级到 3.2 或 3.0。</p></blockquote><ul><li>访问 <a class="link" target="_blank" rel="noopener" href="https://openssl.org/">openssl 官网 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a> 下载并解压源码</li><li>指定安装路径，以下的 <code>[path]</code> 需保持一致</li></ul><div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./config --prefix=`[path]`</span><br></pre></td></tr></table></figure></div><ul><li>开始多线程编译安装</li></ul><div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">make -j $(<span class="built_in">nproc</span>) &amp;&amp; make install -j $(<span class="built_in">nproc</span>)</span><br></pre></td></tr></table></figure></div><ul><li>添加新版本 openssl 软连接</li></ul><div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">ln</span> -s `[path]`/bin/openssl /usr/bin/openssl</span><br><span class="line"><span class="built_in">ln</span> -s `[path]`/include/openssl /usr/include/openssl</span><br></pre></td></tr></table></figure></div><ul><li>新的库文件地址写入记录 so 库的配置文件中</li></ul><div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&quot;[path]/lib64&quot;</span> &gt;&gt; /etc/ld.so.conf</span><br></pre></td></tr></table></figure></div><ul><li>使配置生效并打印出来。</li></ul><div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ldconfig -v</span><br></pre></td></tr></table></figure></div><ul><li>查看版本是否更新</li></ul><div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">openssl version</span><br></pre></td></tr></table></figure></div><h2 id="编译安装-Nginx"><a href="#编译安装-Nginx" class="headerlink" title="编译安装 Nginx"></a>编译安装 Nginx</h2><p>以下使用 <code>/usr/local/src/</code> 存放源代码，使用 <code>/usr/local/nginx</code> 存放安装路径</p><ul><li>创建一个 nginx 用户，为了降低服务器风险，让 nginx 以最小的权限运行</li></ul><div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">useradd -s /sbin/nologin nginx <span class="comment"># 删除用户及其用户目录 userdel -r username</span></span><br></pre></td></tr></table></figure></div><blockquote><p>查看所有登录 shell 不为 &#x2F; sbin&#x2F;nologin 或 &#x2F; bin&#x2F;false 用户：grep -vE ‘&#x2F;sbin&#x2F;nologin|&#x2F;bin&#x2F;false’ &#x2F;etc&#x2F;passwd</p></blockquote><ul><li>下载 nginx 源码<br>访问 <a class="link" target="_blank" rel="noopener" href="https://nginx.org/en/download.html">nginx 下载页面 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>，复制下载链接运行以下命令：</li></ul><div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget https://nginx.org/download/nginx-x.x.x.tar.gz <span class="comment"># x.x.x 为具体的版本号</span></span><br></pre></td></tr></table></figure></div><ul><li>解压 nginx 源码</li></ul><div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -xzf nginx-x.x.x.tar.gz <span class="comment"># x 表示提取 z 表示使用 gzip（通常用户. tar.gz 或. tgz 文件） f 表示指定要操作的文件 v 可选：表示显示详细的操作信息</span></span><br></pre></td></tr></table></figure></div><ul><li>运行 configure 配置脚本<br>以下配置项参考 <a class="link" target="_blank" rel="noopener" href="https://nginx.org/en/docs/configure.html">nginx 文档 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></li></ul><div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./configure --prefix=/usr/local/nginx --user=nginx --group=nginx --with-http_ssl_module <span class="comment">#设置安装路径 设置用户 设置用户组 添加 https 支持</span></span><br></pre></td></tr></table></figure></div><ul><li>编译和安装</li></ul><div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">make -j$(<span class="built_in">nproc</span>) &amp;&amp; make install -j$(<span class="built_in">nproc</span>) <span class="comment"># 自动最大线程编译安装</span></span><br></pre></td></tr></table></figure></div><ul><li>启动和验证</li></ul><div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /usr/local/nginx/sbin &amp;&amp; ./nginx <span class="comment">#启动</span></span><br><span class="line">./nginx -t <span class="comment"># 验证配置文件</span></span><br><span class="line">./nginx -v <span class="comment"># 查看版本</span></span><br><span class="line">curl http://localhost <span class="comment"># 访问默认页面，启动成功会回显 nginx 欢迎页面的 html 响应</span></span><br></pre></td></tr></table></figure></div><ul><li><p>其他配置</p><ul><li>使用软链接将 nginx 添加到系统的可执行路径中</li></ul><div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">ln</span> -s /usr/local/nginx/sbin/nginx /usr/bin/nginx</span><br></pre></td></tr></table></figure></div><ul><li>编写 &#x2F; usr&#x2F;lib&#x2F;systemd&#x2F;system&#x2F;nginx.service，使用 systemctl 管理 nginx</li></ul></li></ul><p>参考 <a class="link" target="_blank" rel="noopener" href="https://systemd.io/">systemd 官网 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>，man 手册 (man systemd.unit)</p><div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">[Unit]</span><br><span class="line">Description=nginx - high performance web server</span><br><span class="line">Documentation=http://nginx.org/en/docs/</span><br><span class="line">After=network.target remote-fs.target nss-lookup.target</span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line">Type=forking</span><br><span class="line">PIDFile=/usr/local/nginx/logs/nginx.pid</span><br><span class="line">ExecStartPre=/usr/local/nginx/sbin/nginx -t -c /usr/local/nginx/conf/nginx.conf</span><br><span class="line">ExecStart=/usr/local/nginx/sbin/nginx -c /usr/local/nginx/conf/nginx.conf</span><br><span class="line">ExecReload=/usr/local/nginx/sbin/nginx -s reload</span><br><span class="line">ExecStop=/usr/local/nginx/sbin/nginx -s stop</span><br><span class="line">PrivateTmp=true</span><br><span class="line"></span><br><span class="line">[Install]</span><br><span class="line">WantedBy=multi-user.target</span><br></pre></td></tr></table></figure></div><ul><li>验证 nginx 是否正常运行：</li></ul><div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl daemon-reload &amp;&amp; systemctl stop nginx.service &amp;&amp; systemctl start nginx.service &amp;&amp; systemctl reload nginx.service &amp;&amp; systemctl restart nginx.service &amp;&amp; systemctl status nginx <span class="comment"># 应显示 Active: active (running) 开机自启（可选）：systemctl enable nginx</span></span><br></pre></td></tr></table></figure></div><h2 id="配置-HTTPS-访问"><a href="#配置-HTTPS-访问" class="headerlink" title="配置 HTTPS 访问"></a>配置 HTTPS 访问</h2><ul><li><p>生成 SSL 证书</p><ul><li>创建.openssl文件夹保存相关文件</li></ul><div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> .openssl &amp;&amp; <span class="built_in">cd</span> .openssl</span><br></pre></td></tr></table></figure></div><ul><li>生成根 CA 的私钥和证书</li></ul><div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 生成根 CA 的私钥</span></span><br><span class="line">openssl genrsa -out rootCA.key 4096</span><br><span class="line"><span class="comment"># 使用私钥生成根 CA 的证书，依次输入国家代码（两个大写字母）、省、市、公司、部门、域名、邮箱</span></span><br><span class="line">openssl req -x509 -new -nodes -key rootCA.key -sha256 -days 30 -out rootCA.crt</span><br></pre></td></tr></table></figure></div><ul><li>为域名生成私钥和证书请求文件（CSR）</li></ul><div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 生成签发证书的私钥 [domain]替换为自己的域名</span></span><br><span class="line">openssl genrsa -out [domain].key 4096</span><br><span class="line"><span class="comment"># 使用私钥生成证书请求文件，依次输入国家代码（两个大写字母）、省、市、公司、部门、域名（可以是泛域名[*.domain]）、邮箱、密码（可以为空，不推荐）</span></span><br><span class="line">openssl req -new -key [domain].key -out [domain].csr</span><br></pre></td></tr></table></figure></div><ul><li>创建证书扩展文件<br>运行<code>vim v3.ext</code>并添加以下内容</li></ul><div class="highlight-container" data-rel="Ini"><figure class="iseeu highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">authorityKeyIdentifier</span>=keyid,issuer</span><br><span class="line"><span class="attr">basicConstraints</span>=CA:<span class="literal">FALSE</span></span><br><span class="line"><span class="attr">keyUsage</span> = digitalSignature, nonRepudiation, keyEncipherment, dataEncipherment</span><br><span class="line"><span class="attr">subjectAltName</span> = @alt_names</span><br><span class="line"></span><br><span class="line"><span class="section">[alt_names]</span></span><br><span class="line"><span class="comment"># 这里 DNS 替换成 IP 就可以签名ip了，[domain]替换为自己的域名</span></span><br><span class="line"><span class="attr">DNS.1</span> = [domain]</span><br><span class="line"><span class="attr">DNS.2</span> = [*.domain]</span><br></pre></td></tr></table></figure></div><ul><li>使用根 CA 的证书为域名签名证书</li></ul><div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">openssl x509 -req -<span class="keyword">in</span> [domain].csr -CA rootCA.crt -CAkey rootCA.key -CAcreateserial -out [domain].crt -days 30 -sha256 -extfile v3.ext</span><br></pre></td></tr></table></figure></div></li><li><p>修改 Nginx 配置文件</p><ul><li>将[domain].crt和[domain].key复制到[ssl-path]<br>cp [domain].crt [domain].key [ssl-path]</li><li>推荐在[nginx-home]&#x2F;conf文件夹下创建一个<code>servers</code>文件夹，然后修改nginx.conf，在http块内添加<code>include servers/*.conf</code></li><li>在<code>servers</code>文件夹下创建<code>80.conf</code>，强制使用https</li></ul><div class="highlight-container" data-rel="Ini"><figure class="iseeu highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">  listen 80<span class="comment">;</span></span><br><span class="line">  server_name _<span class="comment">;</span></span><br><span class="line"></span><br><span class="line">  return 301 https://$host$request_uri<span class="comment">;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><ul><li>在<code>servers</code>文件夹下创建<code>443.conf</code></li></ul><div class="highlight-container" data-rel="Ini"><figure class="iseeu highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">  listen 443 ssl<span class="comment">;</span></span><br><span class="line">  server_name <span class="section">[domain]</span><span class="comment">;</span></span><br><span class="line"></span><br><span class="line">  ssl_certificate <span class="section">[ssl-path]</span>/<span class="section">[domain]</span>.crt</span><br><span class="line">  ssl_certificate_key <span class="section">[ssl-path]</span>/<span class="section">[domain]</span>.key</span><br><span class="line"></span><br><span class="line">  <span class="comment"># location配置</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><p>验证nginx配置文件和重启nginx使配置文件生效</p><div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nginx -t &amp;&amp; nginx -s reload</span><br></pre></td></tr></table></figure></div></li><li><p>安装根证书</p><ul><li>Ubuntu</li></ul><div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cp</span> rootCA.crt /usr/local/share/ca-certificates</span><br><span class="line">update-ca-certificates</span><br></pre></td></tr></table></figure></div><ul><li>CentOS</li></ul><div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cp</span> rootCA.crt /etc/pki/ca-trust/source/anchors/</span><br><span class="line">update-ca-trust</span><br></pre></td></tr></table></figure></div><ul><li>Windows<br>右键<code>rootCA.crt</code>，选择<code>安装证书</code>，选择<code>个人用户</code>或者<code>本地计算机</code>，选择将所有的证书都放入下列存储，指定安装到受信任的根证书颁发机构，点击确定，提示安全警告，阅读完毕选择<code>是</code>，提示导入成功就可以了</li></ul></li></ul></div><div class="post-copyright-info w-full my-8 px-2 sm:px-6 md:px-8"><div class="article-copyright-info-container"><ul><li><strong>标题:</strong> 从零开始：在 WSL 上编译安装 Nginx，配置 HTTPS 访问</li><li><strong>作者:</strong> 叶舒雨</li><li><strong>创建于 :</strong> 2024-06-25 18:30:53</li><li><strong>更新于 :</strong> 2024-06-30 21:08:48</li><li><strong>链接:</strong> https://shuyuwa.github.io/20240625/c2b0cfa83d1f/</li><li><strong>版权声明: </strong>本文章采用 <a class="license" target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0">CC BY-NC-SA 4.0</a> 进行许可。</li></ul></div></div><ul class="post-tags-box text-lg mt-1.5 flex-wrap justify-center flex md:hidden"><li class="tag-item mx-0.5"><a href="/tags/kickoff/">#kickoff</a>&nbsp;</li><li class="tag-item mx-0.5"><a href="/tags/wsl/">#wsl</a>&nbsp;</li><li class="tag-item mx-0.5"><a href="/tags/windows/">#windows</a>&nbsp;</li><li class="tag-item mx-0.5"><a href="/tags/make/">#make</a>&nbsp;</li><li class="tag-item mx-0.5"><a href="/tags/nginx/">#nginx</a>&nbsp;</li></ul><div class="recommended-article px-2 sm:px-6 md:px-8"><div class="recommended-desktop"><div class="recommended-article-header text-xl md:text-3xl font-bold mt-10"><i aria-hidden="true"></i><span>推荐阅读</span></div><div class="recommended-article-group"><a class="recommended-article-item" href="/20240628/e7947259b53c/" title="从零开始：开发环境搭建" rel="bookmark"><img src="/images/wallhaven-wqery6-light.webp" alt="从零开始：开发环境搭建" class="!max-w-none"> <span class="title">从零开始：开发环境搭建</span> </a><a class="recommended-article-item" href="/20240627/d80381243020/" title="从零开始：在 WSL 上编译安装 MySQL" rel="bookmark"><img src="/images/wallhaven-wqery6-light.webp" alt="从零开始：在 WSL 上编译安装 MySQL" class="!max-w-none"> <span class="title">从零开始：在 WSL 上编译安装 MySQL</span> </a><a class="recommended-article-item" href="/20240629/c6963d3260b4/" title="记一次 nodejieba 安装不上的解决思路" rel="bookmark"><img src="/images/wallhaven-wqery6-light.webp" alt="记一次 nodejieba 安装不上的解决思路" class="!max-w-none"> <span class="title">记一次 nodejieba 安装不上的解决思路</span></a></div></div><div class="recommended-mobile"><div class="recommended-article-header text-xl md:text-3xl font-bold mt-10"><i aria-hidden="true"></i><span>推荐阅读</span></div><div class="recommended-article-group"><a class="recommended-article-item" href="/20240628/e7947259b53c/" title="从零开始：开发环境搭建" rel="bookmark"><img src="/images/wallhaven-wqery6-light.webp" alt="从零开始：开发环境搭建" class="!max-w-none"> <span class="title">从零开始：开发环境搭建</span> </a><a class="recommended-article-item" href="/20240627/d80381243020/" title="从零开始：在 WSL 上编译安装 MySQL" rel="bookmark"><img src="/images/wallhaven-wqery6-light.webp" alt="从零开始：在 WSL 上编译安装 MySQL" class="!max-w-none"> <span class="title">从零开始：在 WSL 上编译安装 MySQL</span></a></div></div></div><div class="article-nav my-8 flex justify-between items-center px-2 sm:px-6 md:px-8"><div class="article-prev border-border-color shadow-redefine-flat shadow-shadow-color-2 rounded-medium px-4 py-2 hover:shadow-redefine-flat-hover hover:shadow-shadow-color-2"><a class="prev" rel="prev" href="/20240627/d80381243020/"><span class="left arrow-icon flex justify-center items-center"><i class="fa-solid fa-chevron-left"></i> </span><span class="title flex justify-center items-center"><span class="post-nav-title-item">从零开始：在 WSL 上编译安装 MySQL</span> <span class="post-nav-item">上一篇</span></span></a></div><div class="article-next border-border-color shadow-redefine-flat shadow-shadow-color-2 rounded-medium px-4 py-2 hover:shadow-redefine-flat-hover hover:shadow-shadow-color-2"><a class="next" rel="next" href="/20240624/ce8ea845cd19/"><span class="title flex justify-center items-center"><span class="post-nav-title-item">利用 NPM 自动化 Git 提交：简化提交变更的流程</span> <span class="post-nav-item">下一篇</span> </span><span class="right arrow-icon flex justify-center items-center"><i class="fa-solid fa-chevron-right"></i></span></a></div></div><div class="comment-container px-2 sm:px-6 md:px-8 pb-8"><div class="comments-container mt-10 w-full"><div id="comment-anchor" class="w-full h-2.5"></div><div class="comment-area-title w-full my-1.5 md:my-2.5 text-xl md:text-3xl font-bold">评论</div><div id="gitalk-container"></div><script data-swup-reload-script src="//cdn.staticfile.org/gitalk/1.8.0/gitalk.min.js"></script><script data-swup-reload-script>function loadGitalk(){let t=decodeURI(location.pathname);t.length>50&&(t=t.substring(0,47)+"...");try{Gitalk&&new Gitalk({clientID:"Ov23liZDdyaP9sg3J6kk",clientSecret:"de2a66b8933958171be69c6e320d682ab1775728",repo:"shuyuwa.github.io",owner:"shuyuwa",admin:["shuyuwa"],id:t,language:"zh-CN",proxy:"https://strong-caramel-969805.netlify.app/github_access_token"}).render("gitalk-container")}catch(t){window.Gitalk=null}}{const t=setTimeout(()=>{loadGitalk(),clearTimeout(t)},1e3)}</script></div></div></div><div class="toc-content-container"><div class="post-toc-wrap"><div class="post-toc"><div class="toc-title">此页目录</div><div class="page-title">从零开始：在 WSL 上编译安装 Nginx，配置 HTTPS 访问</div><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%83%8C%E6%99%AF"><span class="nav-text">背景</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%8E%AF%E5%A2%83"><span class="nav-text">环境</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%87%86%E5%A4%87%E5%B7%A5%E4%BD%9C"><span class="nav-text">准备工作</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-%E5%AE%89%E8%A3%85-wsl"><span class="nav-text">1. 安装 wsl</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-%E5%AE%89%E8%A3%85%E7%BC%96%E8%AF%91%E5%B7%A5%E5%85%B7"><span class="nav-text">2. 安装编译工具</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-%E6%9B%B4%E6%96%B0-openssl-%E7%89%88%E6%9C%AC%EF%BC%88%E5%8F%AF%E9%80%89%EF%BC%89"><span class="nav-text">3. 更新 openssl 版本（可选）</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%BC%96%E8%AF%91%E5%AE%89%E8%A3%85-Nginx"><span class="nav-text">编译安装 Nginx</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%85%8D%E7%BD%AE-HTTPS-%E8%AE%BF%E9%97%AE"><span class="nav-text">配置 HTTPS 访问</span></a></li></ol></div></div></div></div></div></div><div class="main-content-footer"><footer class="footer mt-5 py-5 h-auto text-base text-third-text-color relative border-t-2 border-t-border-color"><div class="info-container py-3 text-center"><div class="text-center">&copy; <span>2024</span> - 2024&nbsp;&nbsp;<i class="fa-solid fa-cog fa-spin" style="--fa-animation-duration:15s"></i>&nbsp;&nbsp;<a href="/">叶舒雨</a><p class="post-count space-x-0.5"><span>共 6 篇文章 </span><span>共 5.6k 字</span></p></div><div class="relative text-center lg:absolute lg:left-[20px] lg:top-1/2 lg:-translate-y-1/2 lg:text-left"><span class="lg:block text-sm">由 <?xml version="1.0" encoding="utf-8"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg class="relative top-[2px] inline-block align-baseline" version="1.1" id="圖層_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="1rem" height="1rem" viewBox="0 0 512 512" enable-background="new 0 0 512 512" xml:space="preserve"><path fill="#0E83CD" d="M256.4,25.8l-200,115.5L56,371.5l199.6,114.7l200-115.5l0.4-230.2L256.4,25.8z M349,354.6l-18.4,10.7l-18.6-11V275H200v79.6l-18.4,10.7l-18.6-11v-197l18.5-10.6l18.5,10.8V237h112v-79.6l18.5-10.6l18.5,10.8V354.6z"/></svg><a target="_blank" class="text-base" href="https://hexo.io">Hexo</a> 驱动</span> <span class="text-sm lg:block">主题&nbsp;<a class="text-base" target="_blank" href="https://github.com/EvanNotFound/hexo-theme-redefine">Redefine v2.6.4</a></span></div><div>博客已运行 <span class="odometer" id="runtime_days"></span> 天 <span class="odometer" id="runtime_hours"></span> 小时 <span class="odometer" id="runtime_minutes"></span> 分钟 <span class="odometer" id="runtime_seconds"></span> 秒</div><script data-swup-reload-script>try{function odometer_init(){document.querySelectorAll(".odometer").forEach(e=>{new Odometer({el:e,format:"( ddd).dd",duration:200})})}odometer_init()}catch(e){}</script></div></footer></div></div><div class="post-tools"><div class="post-tools-container"><ul class="article-tools-list"><li class="right-bottom-tools page-aside-toggle"><i class="fa-regular fa-outdent"></i></li><li class="go-comment"><i class="fa-regular fa-comments"></i></li></ul></div></div><div class="right-side-tools-container"><div class="side-tools-container"><ul class="hidden-tools-list"><li class="right-bottom-tools tool-font-adjust-plus flex justify-center items-center"><i class="fa-regular fa-magnifying-glass-plus"></i></li><li class="right-bottom-tools tool-font-adjust-minus flex justify-center items-center"><i class="fa-regular fa-magnifying-glass-minus"></i></li><li class="right-bottom-tools tool-dark-light-toggle flex justify-center items-center"><i class="fa-regular fa-moon"></i></li><li class="right-bottom-tools tool-scroll-to-bottom flex justify-center items-center"><i class="fa-regular fa-arrow-down"></i></li></ul><ul class="visible-tools-list"><li class="right-bottom-tools toggle-tools-list flex justify-center items-center"><i class="fa-regular fa-cog fa-spin"></i></li><li class="right-bottom-tools tool-scroll-to-top flex justify-center items-center"><i class="arrow-up fas fa-arrow-up"></i> <span class="percent"></span></li></ul></div></div><div class="image-viewer-container"><img src=""></div><div class="search-pop-overlay"><div class="popup search-popup"><div class="search-header"><span class="search-input-field-pre"><i class="fa-solid fa-keyboard"></i></span><div class="search-input-container"><input autocomplete="off" autocorrect="off" autocapitalize="off" placeholder="搜索..." spellcheck="false" type="search" class="search-input"></div><span class="popup-btn-close"><i class="fa-solid fa-times"></i></span></div><div id="search-result"><div id="no-result"><i class="fa-solid fa-spinner fa-spin-pulse fa-5x fa-fw"></i></div></div></div></div></main><script src="https://registry.npmmirror.com/hexo-theme-redefine/2.6.4/files/source/js/libs/Swup.min.js"></script><script src="https://registry.npmmirror.com/hexo-theme-redefine/2.6.4/files/source/js/libs/SwupSlideTheme.min.js"></script><script src="https://registry.npmmirror.com/hexo-theme-redefine/2.6.4/files/source/js/libs/SwupScriptsPlugin.min.js"></script><script src="https://registry.npmmirror.com/hexo-theme-redefine/2.6.4/files/source/js/libs/SwupProgressPlugin.min.js"></script><script src="https://registry.npmmirror.com/hexo-theme-redefine/2.6.4/files/source/js/libs/SwupScrollPlugin.min.js"></script><script src="https://registry.npmmirror.com/hexo-theme-redefine/2.6.4/files/source/js/libs/SwupPreloadPlugin.min.js"></script><script>const swup=new Swup({plugins:[new SwupScriptsPlugin({optin:!0}),new SwupProgressPlugin,new SwupScrollPlugin({offset:80}),new SwupSlideTheme({mainElement:".main-content-body"}),new SwupPreloadPlugin],containers:["#swup"]})</script><script type="module" src="https://registry.npmmirror.com/hexo-theme-redefine/2.6.4/files/source/js/tools/imageViewer.js"></script><script type="module" src="https://registry.npmmirror.com/hexo-theme-redefine/2.6.4/files/source/js/utils.js"></script><script type="module" src="https://registry.npmmirror.com/hexo-theme-redefine/2.6.4/files/source/js/main.js"></script><script type="module" src="https://registry.npmmirror.com/hexo-theme-redefine/2.6.4/files/source/js/layouts/navbarShrink.js"></script><script type="module" src="https://registry.npmmirror.com/hexo-theme-redefine/2.6.4/files/source/js/tools/scrollTopBottom.js"></script><script type="module" src="https://registry.npmmirror.com/hexo-theme-redefine/2.6.4/files/source/js/tools/lightDarkSwitch.js"></script><script type="module" src="https://registry.npmmirror.com/hexo-theme-redefine/2.6.4/files/source/js/layouts/categoryList.js"></script><script type="module" src="https://registry.npmmirror.com/hexo-theme-redefine/2.6.4/files/source/js/tools/localSearch.js"></script><script type="module" src="https://registry.npmmirror.com/hexo-theme-redefine/2.6.4/files/source/js/tools/codeBlock.js"></script><script type="module" src="https://registry.npmmirror.com/hexo-theme-redefine/2.6.4/files/source/js/layouts/lazyload.js"></script><script src="https://registry.npmmirror.com/hexo-theme-redefine/2.6.4/files/source/js/tools/runtime.js"></script><script src="https://registry.npmmirror.com/hexo-theme-redefine/2.6.4/files/source/js/libs/odometer.min.js"></script><link rel="stylesheet" href="https://registry.npmmirror.com/hexo-theme-redefine/2.6.4/files/source/assets/odometer-theme-minimal.css"><script src="https://registry.npmmirror.com/hexo-theme-redefine/2.6.4/files/source/js/libs/Typed.min.js"></script><script type="module" src="https://registry.npmmirror.com/hexo-theme-redefine/2.6.4/files/source/js/plugins/typed.js"></script><div class="post-scripts" data-swup-reload-script><script type="module" src="https://registry.npmmirror.com/hexo-theme-redefine/2.6.4/files/source/js/tools/tocToggle.js"></script><script type="module" src="https://registry.npmmirror.com/hexo-theme-redefine/2.6.4/files/source/js/layouts/toc.js"></script><script type="module" src="https://registry.npmmirror.com/hexo-theme-redefine/2.6.4/files/source/js/plugins/tabs.js"></script></div></body></html>